# Выжимка проекта Steel and Chalk

## Общее описание

**Steel and Chalk** — это 2D roguelike игра с пошаговой системой перемещения, реализованная на движке Unity. Проект демонстрирует современные архитектурные подходы и паттерны программирования, применяемые в разработке игр.

## Основные особенности

- **Пошаговая система перемещения**: Игрок перемещается по сетке с дискретными шагами
- **Процедурная генерация уровней**: Комнаты генерируются алгоритмически
- **Система команд (Command Pattern)**: Для управления действиями игрока
- **Внедрение зависимостей (DI)**: С использованием фреймворка VContainer
- **Событийная архитектура**: Связь между компонентами через систему событий
- **Модульная архитектура**: Четкое разделение ответственности между компонентами

## Архитектурные паттерны

### 1. Command Pattern (Паттерн Команда)

Используется для реализации системы действий игрока:

- **ICommand**: Интерфейс команды с методами Execute() и Undo()
- **CommandInvoker**: Исполнитель команд, управляет очередью и отменой команд
- **CommandService**: Сервис управления командами
- **PlayerReceiver**: Получатель команд (в данном случае - перемещение игрока)
- **Конкретные команды**: MoveCommand, RoomMoveCommand

#### Преимущества:
- Возможность отмены действий
- История команд
- Гибкость добавления новых команд
- Четкое разделение ответственности

### 2. Dependency Injection (Внедрение зависимостей)

Используется фреймворк VContainer:

- **LifetimeScope**: Определение областей жизни зависимостей
- **[Inject]**: Атрибут для внедрения зависимостей
- **Преимущества**: Упрощение тестирования, уменьшение зацепления, автоматическое управление жизненным циклом

### 3. Event System (Система событий)

Центральная шина событий:

- **IEventBus**: Интерфейс шины событий
- **EventBus**: Реализация шины событий
- **Записи событий (records)**: Используются для передачи данных между компонентами
- **Преимущества**: Слабое зацепление, гибкость взаимодействия между компонентами

### 4. State Machine (Машина состояний)

Управление состояниями игры:

- **IGameStateMachine**: Интерфейс машины состояний
- **BaseState**: Базовый класс состояния
- **Конкретные состояния**: MainMenuState, GameplayState, PauseState и др.
- **Преимущества**: Четкое управление потоком игры, легкое добавление новых состояний

## Структура проекта

### Core (Основные системы)
- **Containers**: DI контейнеры и настройка зависимостей
- **EventBus**: Система событий
- **GameStateMachine**: Машина состояний игры
- **Systems/Handlers**: Обработчики различных событий

### Framework (Переиспользуемые компоненты)
- **Events**: Определения событий
- **Services**: Бизнес-логика и сервисы
- **Systems**: Общие игровые системы (команды, действия)

### Game (Игровые компоненты)
- **World**: Компоненты мира и генерации
- **Items**: Предметы и интерактивные объекты
- **Player**: Компоненты, связанные с игроком
- **UI**: Элементы пользовательского интерфейса

## Системы проекта

### Система перемещения
- Использует Command Pattern для управления перемещением
- Поддерживает перемещение как в пределах комнаты, так и между комнатами
- Интегрирована с системой ввода и событийной системой
- Обеспечивает проверку проходимости клеток

### Система генерации уровней
- Генерирует комнаты процедурно
- Управляет переходами между комнатами
- Использует графовую структуру для представления связей между комнатами
- Интегрирована с системой событий

### Система ввода
- Использует Input System от Unity
- Абстрагирована через интерфейс IInputService
- Поддерживает разные типы ввода (клавиатура, геймпад)
- Интегрирована с системой событий

### Система событий
- Централизованная шина событий
- Поддерживает подписку и публикацию событий
- Используется для связи между различными частями приложения
- Обеспечивает слабое зацепление компонентов

## Технические детали

### Используемые технологии
- **Unity 2D**: Для создания 2D игрового мира
- **VContainer**: Для внедрения зависимостей
- **Unity Input System**: Для обработки ввода
- **Tilemaps**: Для создания сеточных уровней
- **ScriptableObjects**: Для конфигурации данных

### Архитектурные принципы
- **SOLID**: Принципы объектно-ориентированного проектирования
- **DRY**: Don't Repeat Yourself (Не повторяйся)
- **KISS**: Keep It Simple, Stupid (Делай проще)
- **YAGNI**: You Aren't Gonna Need It (Тебе это не понадобится)
- **Модульность**: Четкое разделение ответственности
- **Тестируемость**: Архитектура позволяет легко тестировать компоненты

## Игровая механика

### Перемещение
- Пошаговое перемещение по сетке
- Проверка проходимости целевой клетки
- Возможность отмены последнего действия
- Поддержка перемещения как в пределах комнаты, так и между комнатами

### Генерация уровней
- Процедурная генерация комнат
- Связывание комнат через двери
- Поддержка различных типов комнат
- Алгоритмы для обеспечения проходимости уровней

### Взаимодействие
- Система ввода для обработки команд игрока
- Событийная система для реакции на действия
- Возможность расширения для добавления интерактивных объектов

## Будущие возможности

### Потенциальные улучшения
- Добавление боевой системы
- Введение системы предметов и инвентаря
- Реализация системы прокачки персонажа
- Добавление различных типов врагов
- Введение системы квестов
- Поддержка мультиплеера

## Заключение

Проект Steel and Chalk представляет собой хорошо структурированное приложение, демонстрирующее современные подходы к разработке игр на Unity. Архитектура проекта позволяет легко расширять функциональность, тестировать компоненты и поддерживать код в порядке. Использование архитектурных паттернов делает код более понятным и гибким, а модульная структура облегчает работу в команде и долгосрочное сопровождение проекта.